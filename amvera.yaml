name: birthday-bot
type: docker

build:
  context: .
  dockerfile: Dockerfile
  args:
    - TELEGRAM_BOT_TOKEN=${TELEGRAM_BOT_TOKEN}
  skip: false

resources:
  cpu: 0.2
  memory: 512Mi

volumes:
  - name: data
    path: /app/data
    size: 1Gi

restart_policy:
  condition: on-failure
  max_retries: 5
  delay: 10s

env:
  - name: DATABASE_PATH
    value: /app/data/birthdays.db
  - name: TELEGRAM_BOT_TOKEN
    value: ${TELEGRAM_BOT_TOKEN}

meta:
  environment: docker
  toolchain: docker

run:
  persistenceMount: /app/data
  containerPort: 80
  
registry:
  image: birthday-bot
  tag: latest 